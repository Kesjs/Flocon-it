(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105,8525],{999:(e,t,s)=>{"use strict";s.d(t,{LF:()=>r,Ow:()=>i,fW:()=>l});var a=s(9981);function r(e,t){try{let s=a.a.getUserOrders(t).find(t=>t.id.includes(e.sessionId)||t.total===e.total&&t.items===e.items&&6e5>Math.abs(new Date(t.date).getTime()-Date.now()));if(s){let t=JSON.parse(localStorage.getItem("flocon_orders")||"[]"),a=t.findIndex(e=>e.id===s.id);if(-1!==a)return t[a].status="Livr\xe9",t[a].shippingAddress=e.shippingAddress,localStorage.setItem("flocon_orders",JSON.stringify(t)),t[a]}return null}catch(e){return null}}function i(e){try{let t=localStorage.getItem("flocon_orders");if(!t)return 0;let s=JSON.parse(t),a=s.filter(t=>t.userId===e).filter(e=>"En pr\xe9paration"===e.status||e.shippingAddress&&e.shippingAddress.address&&e.shippingAddress.address.includes("En attente")),r=0;return a.forEach(e=>{let t=s.findIndex(t=>t.id===e.id);if(-1!==t){var a,i;let l=localStorage.getItem("checkout-shipping-address"),n={name:(null==(a=e.shippingAddress)?void 0:a.name)||"Client",address:"Adresse synchronis\xe9e manuellement",city:"Ville synchronis\xe9e",postalCode:"00000",phone:"T\xe9l\xe9phone synchronis\xe9"};if(l)try{let t=JSON.parse(l);n={name:t.name||(null==(i=e.shippingAddress)?void 0:i.name)||"Client",address:t.address||"Adresse confirm\xe9e",city:t.city||"Ville confirm\xe9e",postalCode:t.postalCode||"00000",phone:t.phone||"T\xe9l\xe9phone confirm\xe9"}}catch(e){}s[t].status="Livr\xe9",s[t].shippingAddress=n,s[t].date=new Date().toISOString(),r++}}),r>0&&localStorage.setItem("flocon_orders",JSON.stringify(s)),r}catch(e){return 0}}function l(e,t){try{let s=JSON.parse(localStorage.getItem("flocon_orders")||"[]"),a=s.findIndex(t=>t.id===e);if(-1!==a)return s[a].status="Livr\xe9",s[a].shippingAddress=t,localStorage.setItem("flocon_orders",JSON.stringify(s)),!0;return!1}catch(e){return!1}}},2529:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>U});var a=s(5155),r=s(2115),i=s(63),l=s(8382),n=s(6617),c=s(1524),o=s(508),d=s(9559),m=s(952),x=s(4926),u=s(5229),h=s(9540),g=s(2619),p=s.n(g),b=s(9730),f=s(9981),y=s(5917),j=s(6983),v=s(8519),N=s(6651),w=s(3581),S=s(1873),A=s(7828),C=s(999);function I(e){let{orders:t,loading:s,searchTerm:i,filterType:c,onSearchChange:o,onFilterChange:m,onOrdersChange:x,userId:u}=e,[h,g]=(0,r.useState)(null),[p,b]=(0,r.useState)(!1),f=async()=>{b(!0);try{if(!u)return void alert("Erreur: utilisateur non identifi\xe9");let e=(0,C.Ow)(u);e>0?(alert("✅ ".concat(e," commande(s) synchronis\xe9e(s) avec succ\xe8s!")),x()):alert("ℹ️ Aucune commande en attente de synchronisation trouv\xe9e")}catch(e){alert("❌ Erreur lors de la synchronisation: "+e.message)}finally{b(!1)}};return s?(0,a.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-rose-custom border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("p",{className:"ml-3 text-gray-600",children:"Chargement des commandes..."})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Mes Commandes"}),(0,a.jsxs)("p",{className:"text-gray-600 mt-1",children:[t.length," commande",t.length>1?"s":"",t.filter(e=>"En pr\xe9paration"===e.status).length>0&&" • ".concat(t.filter(e=>"En pr\xe9paration"===e.status).length," en attente de synchronisation")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{let e=localStorage.getItem("flocon_orders");if(e)try{let t=JSON.parse(e).filter(e=>e.userId===u);t.forEach((e,t)=>{}),t.filter(e=>"En pr\xe9paration"===e.status||e.shippingAddress&&e.shippingAddress.address&&e.shippingAddress.address.includes("En attente")).forEach((e,t)=>{})}catch(e){}let t=localStorage.getItem("checkout-shipping-address");if(t)try{JSON.parse(t)}catch(e){}},className:"flex items-center gap-2 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:"Debug"}),(0,a.jsx)("button",{onClick:()=>{(function(e){try{let t={id:"TEST-".concat(Date.now()),userId:e,date:new Date().toISOString(),status:"En pr\xe9paration",total:99.99,items:2,products:[{id:"test-1",name:"Produit Test 1",price:49.99,quantity:1,image:"/logof.jpg"},{id:"test-2",name:"Produit Test 2",price:50,quantity:1,image:"/logof.jpg"}],shippingAddress:{name:"Test User",address:"En attente de confirmation webhook",city:"En attente de confirmation webhook",postalCode:"00000",phone:"En attente de confirmation webhook"}},s=JSON.parse(localStorage.getItem("flocon_orders")||"[]");return s.push(t),localStorage.setItem("flocon_orders",JSON.stringify(s)),t}catch(e){return null}})(u)&&x()},className:"flex items-center gap-2 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:"Test"}),(0,a.jsxs)("button",{onClick:f,disabled:p,className:"flex items-center gap-2 px-4 py-2 bg-rose-custom text-white rounded-lg hover:bg-rose-custom/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 ".concat(p?"animate-spin":"")}),p?"Synchronisation...":"Synchroniser"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(N.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Rechercher une commande...",value:i,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-custom focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"w-5 h-5 text-gray-500"}),(0,a.jsxs)("select",{value:c,onChange:e=>m(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose-custom focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"Toutes"}),(0,a.jsx)("option",{value:"stripe",children:"Stripe"}),(0,a.jsx)("option",{value:"test",children:"Test"})]})]})]}),0===t.length?(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)(n.A,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Aucune commande"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"all"!==c?"Aucune commande ".concat(c," trouv\xe9e"):"Commencez vos achats pour voir vos commandes ici"}),(0,a.jsx)("button",{onClick:x,className:"px-6 py-2 bg-rose-custom text-white rounded-lg hover:bg-rose-custom/90 transition-colors",children:"Actualiser"})]}):(0,a.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>{var s;let r=(s=e.id).includes("cs_test_")?{type:"stripe",label:"Stripe",color:"bg-purple-100 text-purple-800",icon:(0,a.jsx)(v.A,{className:"w-3 h-3"})}:s.includes("CMD-")?{type:"test",label:"Test",color:"bg-green-100 text-green-800",icon:(0,a.jsx)(y.A,{className:"w-3 h-3"})}:{type:"unknown",label:"Inconnu",color:"bg-gray-100 text-gray-800",icon:null},i=h===e.id;return(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Commande #",e.id.slice(-8)]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"Livr\xe9":return"bg-green-100 text-green-800";case"En pr\xe9paration":return"bg-blue-100 text-blue-800";case"En cours":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:[(e=>{switch(e){case"Livr\xe9":return(0,a.jsx)(y.A,{className:"w-3 h-3"});case"En pr\xe9paration":return(0,a.jsx)(j.A,{className:"w-3 h-3"});case"En cours":return(0,a.jsx)(v.A,{className:"w-3 h-3"});default:return null}})(e.status),e.status]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(r.color),children:[r.icon,r.label]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:new Date(e.date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-xl font-bold text-rose-custom",children:[e.total.toFixed(2)," €"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[e.items," article",e.items>1?"s":""]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-4",children:[(0,a.jsx)(n.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[e.products.slice(0,2).map(e=>e.name).join(", "),e.products.length>2&&" +".concat(e.products.length-2," autre").concat(e.products.length>2?"s":"")]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[e.shippingAddress&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,a.jsx)(S.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[e.shippingAddress.address,", ",e.shippingAddress.city]})]}),(0,a.jsxs)("button",{onClick:()=>g(i?null:e.id),className:"flex items-center gap-2 text-rose-custom hover:text-rose-custom/80 transition-colors",children:[(0,a.jsx)(A.A,{className:"w-4 h-4"}),i?"Masquer":"D\xe9tails"]})]})]}),i&&(0,a.jsx)(l.P.div,{initial:{height:0},animate:{height:"auto"},className:"border-t border-gray-200 bg-gray-50",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-4",children:"D\xe9tails de la commande"}),(0,a.jsx)("div",{className:"space-y-3 mb-6",children:e.products.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 bg-white rounded-lg",children:[(0,a.jsx)("img",{src:e.image,alt:e.name,className:"w-16 h-16 rounded-lg object-cover"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Quantit\xe9: ",e.quantity," \xd7 ",e.price.toFixed(2)," €"]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"font-semibold text-gray-900",children:[(e.price*e.quantity).toFixed(2)," €"]})})]},t))}),e.shippingAddress&&(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-900 mb-2",children:"Adresse de livraison"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsx)("p",{children:e.shippingAddress.name}),(0,a.jsx)("p",{children:e.shippingAddress.address}),(0,a.jsxs)("p",{children:[e.shippingAddress.postalCode," ",e.shippingAddress.city]}),(0,a.jsx)("p",{children:e.shippingAddress.phone})]})]})]})})]},e.id)})})]})}var E=s(3664),O=s(6485),k=s(5998),D=s(7910),_=s(5870),P=s(9347);function M(e){let{user:t,onLogout:s}=e,r=(null==t?void 0:t.created_at)?new Date(t.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):"Date inconnue",i=[{icon:E.A,label:"Email",value:(null==t?void 0:t.email)||"Non renseign\xe9",type:"email"},{icon:O.A,label:"Membre depuis",value:r,type:"date"},{icon:o.A,label:"ID Utilisateur",value:(null==t?void 0:t.id)?t.id.slice(0,8)+"...":"Non disponible",type:"id"}],n=[{icon:k.A,label:"Notifications Email",description:"Recevoir les confirmations de commande et les promotions",enabled:!0},{icon:v.A,label:"Sauvegarder les cartes",description:"Enregistrer les cartes pour un paiement plus rapide",enabled:!1},{icon:S.A,label:"Adresse par d\xe9faut",description:"Utiliser l'adresse principale pour les livraisons",enabled:!0}],c=[{icon:v.A,label:"Moyens de paiement",description:"G\xe9rer vos cartes et m\xe9thodes de paiement",action:"payment"},{icon:S.A,label:"Adresses de livraison",description:"G\xe9rer vos adresses de livraison",action:"addresses"},{icon:D.A,label:"S\xe9curit\xe9",description:"Mot de passe et authentification",action:"security"},{icon:_.A,label:"Pr\xe9f\xe9rences",description:"Personnaliser votre exp\xe9rience",action:"preferences"}];return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Mon Profil"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"G\xe9rez vos informations et pr\xe9f\xe9rences"})]}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-rose-custom to-purple-600 rounded-xl p-8 text-white mb-8",children:(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("div",{className:"w-24 h-24 bg-white/20 rounded-full flex items-center justify-center",children:(0,a.jsx)(o.A,{className:"w-12 h-12"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold mb-2",children:(()=>{var e;let s=null==t||null==(e=t.email)?void 0:e.split("@")[0];return s?s.charAt(0).toUpperCase()+s.slice(1):"Utilisateur"})()}),(0,a.jsx)("p",{className:"text-white/90 mb-4",children:null==t?void 0:t.email}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-white/20 rounded-lg px-4 py-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(P.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"font-medium",children:"Client Fid\xe8le"})]})}),(0,a.jsxs)("div",{className:"text-white/80 text-sm",children:["Membre depuis ",r]})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(l.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Informations Personnelles"}),(0,a.jsx)("div",{className:"space-y-4",children:i.map((e,t)=>{let s=e.icon;return(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,a.jsx)(s,{className:"w-5 h-5 text-gray-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.label}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.value})]})]},e.label)})})]}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Pr\xe9f\xe9rences"}),(0,a.jsx)("div",{className:"space-y-4",children:n.map((e,t)=>{let s=e.icon;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-gray-100 rounded-lg",children:(0,a.jsx)(s,{className:"w-5 h-5 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:e.description})]})]}),(0,a.jsx)("button",{className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors ".concat(e.enabled?"bg-rose-custom":"bg-gray-300"),children:(0,a.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(e.enabled?"translate-x-6":"translate-x-1")})})]},e.label)})})]})]}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Actions Rapides"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:c.map((e,t)=>{let s=e.icon;return(0,a.jsxs)("button",{className:"flex flex-col items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("div",{className:"p-3 bg-rose-custom/10 rounded-lg",children:(0,a.jsx)(s,{className:"w-6 h-6 text-rose-custom"})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.description})]})]},e.label)})})]}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-900 mb-4",children:"Zone de Danger"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-red-900",children:"Supprimer le compte"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:"Supprimez d\xe9finitivement votre compte et toutes vos donn\xe9es"})]}),(0,a.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Supprimer"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-red-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-red-900",children:"D\xe9connexion"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:"D\xe9connectez-vous de votre compte"})]}),(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm",children:"D\xe9connexion"})]})]})]})]})}var T=s(512),J=s(7013),F=s(7840);function L(e){let{orders:t,user:s}=e,r=t.length,i=t.reduce((e,t)=>e+t.total,0),o=r>0?i/r:0,d=t.filter(e=>"Livr\xe9"===e.status).length,m=t.filter(e=>"En pr\xe9paration"===e.status).length,x=t.filter(e=>"En cours"===e.status).length,u=t.filter(e=>e.id.includes("cs_test_")).length,h=t.filter(e=>e.id.includes("CMD-")&&!e.id.includes("cs_test_")).length,g=t.filter(e=>{let t=new Date(e.date),s=new Date;return t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear()}).length,p=Math.max(0,g-Math.floor(3*Math.random())),b=[{title:"Total Commandes",value:r.toString(),change:g-p,changeText:"vs mois dernier",icon:n.A,color:"bg-blue-500",bgColor:"bg-blue-50"},{title:"Total D\xe9pens\xe9",value:"".concat(i.toFixed(2)," €"),change:12.5*(i>0),changeText:"vs mois dernier",icon:v.A,color:"bg-green-500",bgColor:"bg-green-50"},{title:"Panier Moyen",value:"".concat(o.toFixed(2)," €"),change:8.2*(o>0),changeText:"vs mois dernier",icon:T.A,color:"bg-purple-500",bgColor:"bg-purple-50"},{title:"Taux de Livraison",value:r>0?"".concat(Math.round(d/r*100),"%"):"0%",change:5.1*(d>0),changeText:"vs mois dernier",icon:c.A,color:"bg-orange-500",bgColor:"bg-orange-50"}],f=[{label:"Livr\xe9",value:d,color:"bg-green-500",percentage:r>0?d/r*100:0},{label:"En pr\xe9paration",value:m,color:"bg-blue-500",percentage:r>0?m/r*100:0},{label:"En cours",value:x,color:"bg-yellow-500",percentage:r>0?x/r*100:0}],y=[{label:"Stripe",value:u,color:"bg-purple-500",percentage:r>0?u/r*100:0},{label:"Test",value:h,color:"bg-green-500",percentage:r>0?h/r*100:0}];return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Statistiques"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Vue d'ensemble de vos commandes et achats"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:b.map((e,t)=>{let s=e.icon,r=e.change>=0;return(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg ".concat(e.bgColor),children:(0,a.jsx)(s,{className:"w-6 h-6 ".concat(e.color," text-white")})}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-sm ".concat(r?"text-green-600":"text-red-600"),children:[r?(0,a.jsx)(J.A,{className:"w-4 h-4"}):(0,a.jsx)(F.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[Math.abs(e.change),"%"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.value}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.changeText})]})]},e.title)})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(l.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"R\xe9partition par Statut"}),(0,a.jsx)("div",{className:"space-y-4",children:f.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.label}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[e.value," commande",e.value>1?"s":""]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)(l.P.div,{initial:{width:0},animate:{width:"".concat(e.percentage,"%")},transition:{delay:.1*t,duration:.5},className:"".concat(e.color," h-2 rounded-full")})}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.percentage.toFixed(1),"%"]})]},e.label))})]}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"R\xe9partition par Type"}),(0,a.jsx)("div",{className:"space-y-4",children:y.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.label}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[e.value," commande",e.value>1?"s":""]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)(l.P.div,{initial:{width:0},animate:{width:"".concat(e.percentage,"%")},transition:{delay:.1*t,duration:.5},className:"".concat(e.color," h-2 rounded-full")})}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.percentage.toFixed(1),"%"]})]},e.label))})]})]}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Activit\xe9 R\xe9cente"}),(0,a.jsxs)("div",{className:"space-y-4",children:[t.slice(0,5).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("Livr\xe9"===e.status?"bg-green-500":"En pr\xe9paration"===e.status?"bg-blue-500":"bg-yellow-500")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Commande #",e.id.slice(-8)]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:new Date(e.date).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[e.total.toFixed(2)," €"]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:e.status})]})]},e.id)),0===t.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(n.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Aucune activit\xe9 r\xe9cente"})]})]})]})]})}function U(){let[e,t]=(0,r.useState)("commandes"),[s,g]=(0,r.useState)(!1),[y,j]=(0,r.useState)([]),[v,N]=(0,r.useState)([]),[w,S]=(0,r.useState)(!0),[A,C]=(0,r.useState)(""),[E,O]=(0,r.useState)("all"),[k,D]=(0,r.useState)(!1),_=(0,i.useRouter)(),{user:P,loading:T,signOut:J}=(0,b.A)();(0,r.useEffect)(()=>{if(!T&&!P)return void _.push("/login")},[P,T,_]),(0,r.useEffect)(()=>{P&&!k&&(D(!0),F())},[P]),(0,r.useEffect)(()=>{let e=y;"stripe"===E?e=e.filter(e=>e.id.includes("cs_test_")):"test"===E&&(e=e.filter(e=>e.id.includes("CMD-")&&!e.id.includes("cs_test_"))),A&&(e=e.filter(e=>e.id.toLowerCase().includes(A.toLowerCase())||e.products.some(e=>e.name.toLowerCase().includes(A.toLowerCase()))||e.status.toLowerCase().includes(A.toLowerCase()))),N(e)},[y,A,E]);let F=()=>{S(!0);try{if(!(null==P?void 0:P.id)){j([]),N([]);return}f.a.removeDuplicateOrders(P.id);let e=f.a.getUserOrders(P.id);j(e),N(e)}catch(e){j([]),N([])}finally{S(!1),D(!1)}},U=async()=>{await J()},q=[{id:"commandes",label:"Mes Commandes",icon:n.A,count:y.length},{id:"statistiques",label:"Statistiques",icon:c.A},{id:"profil",label:"Profil",icon:o.A}];return T||w?(0,a.jsx)("div",{className:"pt-28 min-h-screen bg-cream flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-rose-custom border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chargement du dashboard..."})]})}):P?(0,a.jsx)("div",{className:"pt-28 min-h-screen bg-cream",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)(l.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-rose-custom/10 rounded-full flex items-center justify-center",children:(0,a.jsx)(o.A,{className:"w-8 h-8 text-rose-custom"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:(()=>{var e;let t=null==(e=P.email)?void 0:e.split("@")[0];return t?t.charAt(0).toUpperCase()+t.slice(1):"Utilisateur"})()}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:P.email})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,a.jsx)(d.A,{className:"w-4 h-4"}),"Actualiser"]}),(0,a.jsxs)(p(),{href:"/boutique",className:"flex items-center gap-2 px-6 py-2 bg-rose-custom text-white rounded-lg hover:bg-rose-custom/90 transition-colors",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"Boutique"]}),(0,a.jsxs)("button",{onClick:U,className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),"D\xe9connexion"]})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,a.jsxs)(l.P.aside,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:"lg:w-64 bg-white rounded-xl shadow-sm border border-gray-200 p-6 ".concat(s?"block":"hidden lg:block"),children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Mon Espace"}),(0,a.jsx)("nav",{className:"space-y-2",children:q.map(s=>{let r=s.icon;return(0,a.jsxs)("button",{onClick:()=>{t(s.id),g(!1)},className:"w-full flex items-center justify-between px-4 py-3 rounded-lg transition-colors ".concat(e===s.id?"bg-rose-custom text-white":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(r,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium",children:s.label})]}),void 0!==s.count&&s.count>0&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(e===s.id?"bg-white/20 text-white":"bg-gray-100 text-gray-600"),children:s.count})]},s.id)})}),(0,a.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,a.jsxs)("button",{onClick:()=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer toutes vos commandes ? Cette action est irr\xe9versible."))try{let e=[];for(let t=0;t<localStorage.length;t++){let s=localStorage.key(t);s&&(s.includes("flocon")||s.includes("order")||s.includes("cart"))&&(e.push(s),localStorage.removeItem(s))}j([]),N([]),D(!1),alert("✅ ".concat(e.length," entr\xe9es supprim\xe9es !"))}catch(e){}},className:"w-full flex items-center gap-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[(0,a.jsx)(u.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Vider les commandes"})]})})]}),(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex-1",children:[(0,a.jsx)("button",{onClick:()=>g(!s),className:"lg:hidden mb-4 p-2 bg-white rounded-lg shadow-sm border border-gray-200",children:s?(0,a.jsx)(u.A,{className:"w-6 h-6"}):(0,a.jsx)(h.A,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:["commandes"===e&&(0,a.jsx)(I,{orders:v,loading:w,searchTerm:A,filterType:E,onSearchChange:C,onFilterChange:O,onOrdersChange:F,userId:(null==P?void 0:P.id)||""}),"statistiques"===e&&(0,a.jsx)(L,{orders:y,user:P}),"profil"===e&&(0,a.jsx)(M,{user:P,onLogout:U})]})]})]})]})}):null}},3903:(e,t,s)=>{Promise.resolve().then(s.bind(s,2529))},8525:(e,t,s)=>{"use strict";s.d(t,{createClient:()=>r});var a=s(5417);function r(){let e="https://xvczqjkmbfpjkdghvomc.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2Y3pxamttYmZwamtkZ2h2b21jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0MjA5MjUsImV4cCI6MjA4NDk5NjkyNX0.Qi9gHILEaBylF8ObdcpXqg9n8wrlX46MFSzlIcZbCG0";return e&&t?(0,a.createBrowserClient)(e,t):null}},9730:(e,t,s)=>{"use strict";s.d(t,{A:()=>o,AuthProvider:()=>c});var a=s(5155),r=s(2115),i=s(8525),l=s(63);let n=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),[m,x]=(0,r.useState)(!0),u=(0,l.useRouter)(),h=(0,i.createClient)();(0,r.useEffect)(()=>{if(!h)return void x(!1);let{data:{subscription:e}}=h.auth.onAuthStateChange((e,t)=>{var s;d(t),c(null!=(s=null==t?void 0:t.user)?s:null),x(!1)});return(async()=>{var e;let{data:{session:t}}=await h.auth.getSession();d(t),c(null!=(e=null==t?void 0:t.user)?e:null),x(!1)})(),()=>{e.unsubscribe()}},[h,u]);let g=async(e,t,s)=>{let a=(0,i.createClient)();if(!a)return{error:{message:"Service d'authentification non disponible"}};let{error:r}=await a.auth.signUp({email:e,password:t,options:{data:s}});return{error:r}},p=async(e,t)=>{let s=(0,i.createClient)();if(!s)return{error:{message:"Service d'authentification non disponible"}};let{error:a}=await s.auth.signInWithPassword({email:e,password:t});return u.refresh(),{error:a}},b=async()=>{let e=(0,i.createClient)();e&&(await e.auth.signOut(),u.refresh())},f=async e=>{let t=(0,i.createClient)();if(!t)return{error:{message:"Service d'authentification non disponible"}};let{error:s}=await t.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});return{error:s}},y=async e=>{let t=(0,i.createClient)();if(!t)return{exists:!1,error:{message:"Service d'authentification non disponible"}};try{var s,a;let{error:r}=await t.auth.signInWithPassword({email:e,password:"dummy-password-for-check-only"});if(null==r||null==(s=r.message)?void 0:s.includes("Invalid login credentials"))return{exists:!1,error:null};if(null==r||null==(a=r.message)?void 0:a.includes("Invalid password"))return{exists:!0,error:null};return{exists:!1,error:r}}catch(e){return{exists:!1,error:e}}},j=async(e,t)=>{let s=(0,i.createClient)();if(!s)return{error:{message:"Service d'authentification non disponible"}};let{error:a}=await s.auth.setSession({access_token:e,refresh_token:t});return a||u.refresh(),{error:a}};return(0,a.jsx)(n.Provider,{value:{user:s,session:o,loading:m,signUp:g,signIn:p,signOut:b,resetPassword:f,checkEmailExists:y,confirmEmail:j},children:t})}function o(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9981:(e,t,s)=>{"use strict";s.d(t,{a:()=>r});let a="flocon_orders";class r{static getUserOrders(e){let t=localStorage.getItem(a);return(t?JSON.parse(t):[]).filter(t=>t.userId===e)}static addOrder(e){let t={...e,id:"CMD-".concat(Date.now()),date:new Date().toISOString()},s=localStorage.getItem(a),r=s?JSON.parse(s):[];return r.push(t),localStorage.setItem(a,JSON.stringify(r)),this.updateUserStats(e.userId,t),t}static removeDuplicateOrders(e){let t=localStorage.getItem(a),s=t?JSON.parse(t):[],r=s.filter(t=>t.userId===e),i=new Map;r.forEach(e=>{let t="".concat(e.total,"-").concat(e.items);i.has(t)||i.set(t,[]),i.get(t).push(e)});let l=0;return i.forEach((e,t)=>{if(e.length>1){e.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()),e[0];let t=e.slice(1),r=s.filter(e=>!t.some(t=>t.id===e.id));localStorage.setItem(a,JSON.stringify(r)),l+=t.length}}),l}static updateOrderStatus(e,t){let s=localStorage.getItem(a),r=s?JSON.parse(s):[],i=r.findIndex(t=>t.id===e);return -1!==i&&(r[i].status=t,localStorage.setItem(a,JSON.stringify(r)),!0)}static getUserStats(e){let t=this.getUserOrders(e),s=t.length,a=t.reduce((e,t)=>e+t.total,0),r=Math.floor(a/10),i={};return t.forEach(e=>{e.products.forEach(e=>{let t="Saint-Valentin";i[t]=(i[t]||0)+1})}),{totalOrders:s,totalSpent:a,favoriteCategory:Object.keys(i).reduce((e,t)=>i[e]>i[t]?e:t,"Saint-Valentin"),memberSince:"D\xe9cembre 2025",loyaltyPoints:r,nextReward:r>=500?"R\xe9duction de -50€ disponible !":"-50€ sur prochaine commande (".concat(500-r," points)")}}static updateUserStats(e,t){let s=this.getUserStats(e);localStorage.setItem("".concat("flocon_user_stats","_").concat(e),JSON.stringify(s))}static createOrderFromCart(e,t,s){let a=t.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity,image:e.images[0]})),r=t.reduce((e,t)=>e+t.price*t.quantity,0),i=t.reduce((e,t)=>e+t.quantity,0);return this.addOrder({userId:e,status:"En attente",total:r,items:i,products:a,shippingAddress:s})}}}},e=>{e.O(0,[8096,7358],()=>e(e.s=3903)),_N_E=e.O()}]);