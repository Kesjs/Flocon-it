(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520,8525],{804:(e,t,r)=>{Promise.resolve().then(r.bind(r,5199))},4389:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});class s{static setIntent(e){try{let t={...e,timestamp:Date.now()};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(e){}}static getIntent(){try{let e=localStorage.getItem(this.STORAGE_KEY);if(!e)return null;let t=JSON.parse(e);if(Date.now()-t.timestamp>this.EXPIRY_TIME)return this.clearIntent(),null;return t}catch(e){return this.clearIntent(),null}}static clearIntent(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(e){}}static setCheckoutIntent(e){this.setIntent({type:"checkout",timestamp:Date.now(),data:e})}static hasCheckoutIntent(){let e=this.getIntent();return(null==e?void 0:e.type)==="checkout"}}s.STORAGE_KEY="redirect_intent",s.EXPIRY_TIME=18e5},5199:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(2115),n=r(8382),i=r(63),l=r(2619),o=r.n(l),c=r(7816),u=r(1078),d=r(3664),m=r(9708),h=r(532),x=r(7828),p=r(2987),f=r(9730),g=r(4389);function v(){let[e,t]=(0,a.useState)(""),[r,l]=(0,a.useState)(""),[v,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(""),[w,N]=(0,a.useState)(!1),[I,k]=(0,a.useState)(""),S=(0,i.useRouter)(),C=(0,i.useSearchParams)(),{signIn:E,checkEmailExists:A}=(0,f.A)(),[_,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{var e;"signup_success"===C.get("status")&&(k("Inscription r\xe9ussie ! Un email de confirmation vous a \xe9t\xe9 envoy\xe9. Merci de v\xe9rifier votre bo\xeete de r\xe9ception."),S.replace("/login",{scroll:!1})),"checkout"===(C.get("redirect")||C.get("redirectTo"))&&P(!0);let r=g.a.getIntent();(null==r?void 0:r.type)==="checkout"&&(null==(e=r.data)?void 0:e.email)&&(t(r.data.email),P(!0))},[C,S]);let O=async t=>{t.preventDefault(),b(!0),j("");let{error:s}=await E(e,r);if(s)if("Invalid login credentials"===s.message){let{exists:t}=await A(e);t?j("Votre compte n'est pas encore confirm\xe9. Veuillez v\xe9rifier votre email et cliquer sur le lien de confirmation."):j("L'email ou le mot de passe est incorrect.")}else j(s.message);else{let e=g.a.getIntent();if((null==e?void 0:e.type)==="checkout")g.a.clearIntent(),S.push("/checkout");else{let e=C.get("redirectTo")||C.get("redirect");"checkout"===e?S.push("/checkout"):S.push(e||"/dashboard")}}b(!1)};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-cream to-iceBlue/20 px-4 pt-20",children:(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-display font-bold text-textDark mb-2",children:"Connexion"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Acc\xe9dez \xe0 votre espace personnel"})]}),I&&(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[(0,s.jsx)(c.A,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-green-700 text-sm",children:I})]}),_&&(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-5 h-5 text-blue-600 flex-shrink-0",children:(0,s.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,s.jsx)("p",{className:"text-blue-700 text-sm",children:"Connectez-vous pour finaliser votre commande. Vous serez redirig\xe9 automatiquement vers la page de paiement."})]}),y&&(0,s.jsxs)(n.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,s.jsx)(u.A,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-red-700 text-sm",children:y})]}),(0,s.jsxs)("form",{onSubmit:O,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-textDark mb-2",children:"Email"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose focus:border-transparent outline-none transition-all",placeholder:"votre@email.com"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-textDark mb-2",children:"Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{id:"password",type:w?"text":"password",value:r,onChange:e=>l(e.target.value),required:!0,className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose focus:border-transparent outline-none transition-all",placeholder:"••••••••"}),(0,s.jsx)("button",{type:"button",onClick:()=>N(!w),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 cursor-pointer",children:w?(0,s.jsx)(h.A,{className:"w-5 h-5"}):(0,s.jsx)(x.A,{className:"w-5 h-5"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-rose-custom focus:ring-rose"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Se souvenir de moi"})]}),(0,s.jsx)(o(),{href:"/forgot-password",className:"text-sm text-rose-custom hover:underline",children:"Mot de passe oubli\xe9 ?"})]}),(0,s.jsx)("button",{type:"submit",disabled:v,className:"w-full bg-rose-custom text-white py-3 rounded-lg font-semibold hover:bg-rose-custom/90 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Connexion..."]}):(0,s.jsxs)(s.Fragment,{children:["Connexion",(0,s.jsx)(p.A,{className:"w-5 h-5"})]})})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("p",{className:"text-gray-600",children:["Vous n'avez pas encore de compte ? "," ",(0,s.jsx)(o(),{href:"/register",className:"text-rose-custom hover:underline font-medium",children:"S'inscrire"})]})})]})})}function b(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(v,{})})}},8525:(e,t,r)=>{"use strict";r.d(t,{createClient:()=>a});var s=r(5417);function a(){let e="https://xvczqjkmbfpjkdghvomc.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2Y3pxamttYmZwamtkZ2h2b21jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0MjA5MjUsImV4cCI6MjA4NDk5NjkyNX0.Qi9gHILEaBylF8ObdcpXqg9n8wrlX46MFSzlIcZbCG0";return e&&t?(0,s.createBrowserClient)(e,t):null}},9730:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>o});var s=r(5155),a=r(2115),n=r(8525),i=r(63);let l=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(!0),h=(0,i.useRouter)(),x=(0,n.createClient)();(0,a.useEffect)(()=>{if(!x)return void m(!1);let{data:{subscription:e}}=x.auth.onAuthStateChange((e,t)=>{var r;u(t),o(null!=(r=null==t?void 0:t.user)?r:null),m(!1)});return(async()=>{var e;let{data:{session:t}}=await x.auth.getSession();u(t),o(null!=(e=null==t?void 0:t.user)?e:null),m(!1)})(),()=>{e.unsubscribe()}},[x,h]);let p=async(e,t,r)=>{let s=(0,n.createClient)();if(!s)return{error:{message:"Service d'authentification non disponible"}};let{error:a}=await s.auth.signUp({email:e,password:t,options:{data:r}});return{error:a}},f=async(e,t)=>{let r=(0,n.createClient)();if(!r)return{error:{message:"Service d'authentification non disponible"}};let{error:s}=await r.auth.signInWithPassword({email:e,password:t});return h.refresh(),{error:s}},g=async()=>{let e=(0,n.createClient)();e&&(await e.auth.signOut(),h.refresh())},v=async e=>{let t=(0,n.createClient)();if(!t)return{error:{message:"Service d'authentification non disponible"}};let{error:r}=await t.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});return{error:r}},b=async e=>{let t=(0,n.createClient)();if(!t)return{exists:!1,error:{message:"Service d'authentification non disponible"}};try{var r,s;let{error:a}=await t.auth.signInWithPassword({email:e,password:"dummy-password-for-check-only"});if(null==a||null==(r=a.message)?void 0:r.includes("Invalid login credentials"))return{exists:!1,error:null};if(null==a||null==(s=a.message)?void 0:s.includes("Invalid password"))return{exists:!0,error:null};return{exists:!1,error:a}}catch(e){return{exists:!1,error:e}}},y=async(e,t)=>{let r=(0,n.createClient)();if(!r)return{error:{message:"Service d'authentification non disponible"}};let{error:s}=await r.auth.setSession({access_token:e,refresh_token:t});return s||h.refresh(),{error:s}};return(0,s.jsx)(l.Provider,{value:{user:r,session:c,loading:d,signUp:p,signIn:f,signOut:g,resetPassword:v,checkEmailExists:b,confirmEmail:y},children:t})}function c(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[8096,7358],()=>e(e.s=804)),_N_E=e.O()}]);