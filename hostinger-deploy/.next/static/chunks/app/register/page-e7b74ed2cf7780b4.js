(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2454,8525],{2418:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(5155),a=r(8382),n=r(2115),i=r(63),l=r(2619),o=r.n(l),c=r(1078),u=r(508),d=r(3664),m=r(9708),h=r(532),p=r(7828),x=r(2987),f=r(9730),b=r(4389);function g(){let[e,t]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),[g,v]=(0,n.useState)(""),[y,j]=(0,n.useState)(""),[w,N]=(0,n.useState)(!1),[I,S]=(0,n.useState)(!1),[k,C]=(0,n.useState)(""),[E,A]=(0,n.useState)(!1),[_,P]=(0,n.useState)(!1),[F,O]=(0,n.useState)(!1),D=(0,i.useRouter)(),{signUp:J,checkEmailExists:R}=(0,f.A)();(0,n.useEffect)(()=>{var e;let r=b.a.getIntent();(null==r?void 0:r.type)==="checkout"&&(null==(e=r.data)?void 0:e.email)&&t(r.data.email)},[]);let Y=async t=>{if(t.preventDefault(),N(!0),C(""),r!==g){C("Les mots de passe ne correspondent pas"),N(!1);return}if(r.length<6){C("Le mot de passe doit contenir au moins 6 caract\xe8res"),N(!1);return}S(!0);let{exists:s,error:a}=await R(e);if(S(!1),a){C("Erreur lors de la v\xe9rification de l'email. Veuillez r\xe9essayer."),N(!1);return}if(s){C("Cet email est d\xe9j\xe0 utilis\xe9. Veuillez vous connecter ou utiliser un autre email."),N(!1);return}let{error:n}=await J(e,r,{full_name:y});if(n)C(n.message),N(!1);else{localStorage.setItem("pending_confirmation_email",e);let t=b.a.getIntent();(null==t?void 0:t.type)==="checkout"?D.push("/pending-confirmation?email=".concat(encodeURIComponent(e),"&redirect=checkout")):D.push("/pending-confirmation?email=".concat(encodeURIComponent(e)))}};return(0,s.jsx)("div",{className:"pt-20 min-h-screen flex items-center justify-center bg-gradient-to-br from-cream to-iceBlue/20 px-4",children:(0,s.jsxs)(a.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-display font-bold text-textDark mb-2",children:"Inscription"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Cr\xe9ez votre espace personnel"})]}),k&&(0,s.jsxs)(a.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,s.jsx)(c.A,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-red-700 text-sm",children:k})]}),(0,s.jsxs)("form",{onSubmit:Y,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-textDark mb-2",children:"Nom complet"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{id:"fullName",type:"text",value:y,onChange:e=>j(e.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose focus:border-transparent outline-none transition-all",placeholder:"Jean Dupont"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-textDark mb-2",children:"Email"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose focus:border-transparent outline-none transition-all",placeholder:"votre@email.com"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-textDark mb-2",children:"Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{id:"password",type:_?"text":"password",value:r,onChange:e=>l(e.target.value),required:!0,className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose focus:border-transparent outline-none transition-all",placeholder:"••••••••"}),(0,s.jsx)("button",{type:"button",onClick:()=>P(!_),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 cursor-pointer",children:_?(0,s.jsx)(h.A,{className:"w-5 h-5"}):(0,s.jsx)(p.A,{className:"w-5 h-5"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-textDark mb-2",children:"Confirmation du mot de passe"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{id:"confirmPassword",type:F?"text":"password",value:g,onChange:e=>v(e.target.value),required:!0,className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-rose focus:border-transparent outline-none transition-all",placeholder:"••••••••"}),(0,s.jsx)("button",{type:"button",onClick:()=>O(!F),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 cursor-pointer",children:F?(0,s.jsx)(h.A,{className:"w-5 h-5"}):(0,s.jsx)(p.A,{className:"w-5 h-5"})})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"terms",required:!0,className:"rounded border-gray-300 text-rose-custom focus:ring-rose"}),(0,s.jsxs)("label",{htmlFor:"terms",className:"ml-2 text-sm text-gray-600",children:["J'accepte les"," ",(0,s.jsx)(o(),{href:"/cgv",className:"text-rose-custom hover:underline",children:"conditions g\xe9n\xe9rales de vente"})," ","et la"," ",(0,s.jsx)(o(),{href:"/politique-confidentialite",className:"text-rose-custom hover:underline",children:"politique de confidentialit\xe9"})]})]}),(0,s.jsx)("button",{type:"submit",disabled:w||I,className:"w-full bg-rose-custom text-white py-3 rounded-lg font-semibold hover:bg-rose-custom/90 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:I?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"V\xe9rification de l'email..."]}):w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Inscription..."]}):(0,s.jsxs)(s.Fragment,{children:["S'inscrire",(0,s.jsx)(x.A,{className:"w-5 h-5"})]})})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsxs)("p",{className:"text-gray-600",children:["Vous avez d\xe9j\xe0 un compte ? "," ",(0,s.jsx)(o(),{href:"/login",className:"text-rose-custom hover:underline font-medium",children:"Se connecter"})]})}),I&&(0,s.jsxs)(a.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("p",{className:"text-blue-700 text-sm",children:"V\xe9rification de la disponibilit\xe9 de l'email..."})]})]})})}},3294:(e,t,r)=>{Promise.resolve().then(r.bind(r,2418))},4389:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});class s{static setIntent(e){try{let t={...e,timestamp:Date.now()};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(e){}}static getIntent(){try{let e=localStorage.getItem(this.STORAGE_KEY);if(!e)return null;let t=JSON.parse(e);if(Date.now()-t.timestamp>this.EXPIRY_TIME)return this.clearIntent(),null;return t}catch(e){return this.clearIntent(),null}}static clearIntent(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(e){}}static setCheckoutIntent(e){this.setIntent({type:"checkout",timestamp:Date.now(),data:e})}static hasCheckoutIntent(){let e=this.getIntent();return(null==e?void 0:e.type)==="checkout"}}s.STORAGE_KEY="redirect_intent",s.EXPIRY_TIME=18e5},8525:(e,t,r)=>{"use strict";r.d(t,{createClient:()=>a});var s=r(5417);function a(){let e="https://xvczqjkmbfpjkdghvomc.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2Y3pxamttYmZwamtkZ2h2b21jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0MjA5MjUsImV4cCI6MjA4NDk5NjkyNX0.Qi9gHILEaBylF8ObdcpXqg9n8wrlX46MFSzlIcZbCG0";return e&&t?(0,s.createBrowserClient)(e,t):null}},9730:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>o});var s=r(5155),a=r(2115),n=r(8525),i=r(63);let l=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(!0),h=(0,i.useRouter)(),p=(0,n.createClient)();(0,a.useEffect)(()=>{if(!p)return void m(!1);let{data:{subscription:e}}=p.auth.onAuthStateChange((e,t)=>{var r;u(t),o(null!=(r=null==t?void 0:t.user)?r:null),m(!1)});return(async()=>{var e;let{data:{session:t}}=await p.auth.getSession();u(t),o(null!=(e=null==t?void 0:t.user)?e:null),m(!1)})(),()=>{e.unsubscribe()}},[p,h]);let x=async(e,t,r)=>{let s=(0,n.createClient)();if(!s)return{error:{message:"Service d'authentification non disponible"}};let{error:a}=await s.auth.signUp({email:e,password:t,options:{data:r}});return{error:a}},f=async(e,t)=>{let r=(0,n.createClient)();if(!r)return{error:{message:"Service d'authentification non disponible"}};let{error:s}=await r.auth.signInWithPassword({email:e,password:t});return h.refresh(),{error:s}},b=async()=>{let e=(0,n.createClient)();e&&(await e.auth.signOut(),h.refresh())},g=async e=>{let t=(0,n.createClient)();if(!t)return{error:{message:"Service d'authentification non disponible"}};let{error:r}=await t.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});return{error:r}},v=async e=>{let t=(0,n.createClient)();if(!t)return{exists:!1,error:{message:"Service d'authentification non disponible"}};try{var r,s;let{error:a}=await t.auth.signInWithPassword({email:e,password:"dummy-password-for-check-only"});if(null==a||null==(r=a.message)?void 0:r.includes("Invalid login credentials"))return{exists:!1,error:null};if(null==a||null==(s=a.message)?void 0:s.includes("Invalid password"))return{exists:!0,error:null};return{exists:!1,error:a}}catch(e){return{exists:!1,error:e}}},y=async(e,t)=>{let r=(0,n.createClient)();if(!r)return{error:{message:"Service d'authentification non disponible"}};let{error:s}=await r.auth.setSession({access_token:e,refresh_token:t});return s||h.refresh(),{error:s}};return(0,s.jsx)(l.Provider,{value:{user:r,session:c,loading:d,signUp:x,signIn:f,signOut:b,resetPassword:g,checkEmailExists:v,confirmEmail:y},children:t})}function c(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[8096,7358],()=>e(e.s=3294)),_N_E=e.O()}]);