(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7784,8525],{4220:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var i=r(5155),s=r(8382),a=r(2115),n=r(63),l=r(919),o=r(7816),u=r(1078),c=r(9730);function d(){let[e,t]=(0,a.useState)("loading"),[d,h]=(0,a.useState)(""),m=(0,n.useRouter)(),f=(0,n.useSearchParams)(),{signIn:x}=(0,c.A)();return(0,a.useEffect)(()=>{(async()=>{try{let e=f.get("access_token"),i=f.get("refresh_token");if(!e||!i){t("error"),h("Lien de confirmation invalide ou expir\xe9."),setTimeout(()=>{m.push("/login")},3e3);return}let{createClient:s}=await Promise.resolve().then(r.bind(r,8525)),a=s();if(!a){t("error"),h("Erreur de configuration. Veuillez r\xe9essayer.");return}let{error:n}=await a.auth.setSession({access_token:e,refresh_token:i});if(n){t("error"),h("Erreur lors de la confirmation. Veuillez r\xe9essayer."),setTimeout(()=>{m.push("/login")},3e3);return}let{data:{user:l}}=await a.auth.getUser();l&&l.email_confirmed_at?(t("success"),h("Email confirm\xe9 avec succ\xe8s ! Redirection vers votre tableau de bord..."),setTimeout(()=>{m.push("/dashboard")},2e3)):(t("error"),h("La confirmation a \xe9chou\xe9. Veuillez contacter le support."),setTimeout(()=>{m.push("/login")},3e3))}catch(e){t("error"),h("Une erreur est survenue. Veuillez r\xe9essayer."),setTimeout(()=>{m.push("/login")},3e3)}})()},[f,m]),(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-cream to-iceBlue/20 px-4 pt-20",children:(0,i.jsxs)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 text-center",children:["loading"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.P.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 mx-auto mb-6",children:(0,i.jsx)(l.A,{className:"w-full h-full text-rose-custom"})}),(0,i.jsx)("h1",{className:"text-2xl font-display font-bold text-textDark mb-4",children:"Confirmation en cours..."}),(0,i.jsx)("p",{className:"text-gray-600",children:"Nous confirmons votre adresse email. Veuillez patienter quelques instants."})]}),"success"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.P.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20},className:"w-16 h-16 mx-auto mb-6 rounded-full bg-green-100 flex items-center justify-center",children:(0,i.jsx)(o.A,{className:"w-8 h-8 text-green-600"})}),(0,i.jsx)("h1",{className:"text-2xl font-display font-bold text-textDark mb-4",children:"Confirmation r\xe9ussie !"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:d}),(0,i.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,i.jsx)(s.P.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:2,ease:"linear"},className:"h-full bg-rose-custom"})})]}),"error"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.P.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20},className:"w-16 h-16 mx-auto mb-6 rounded-full bg-red-100 flex items-center justify-center",children:(0,i.jsx)(u.A,{className:"w-8 h-8 text-red-600"})}),(0,i.jsx)("h1",{className:"text-2xl font-display font-bold text-textDark mb-4",children:"Erreur de confirmation"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:d}),(0,i.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,i.jsx)(s.P.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:3,ease:"linear"},className:"h-full bg-red-500"})})]})]})})}},5972:(e,t,r)=>{Promise.resolve().then(r.bind(r,4220))},8525:(e,t,r)=>{"use strict";r.d(t,{createClient:()=>s});var i=r(5417);function s(){let e="https://xvczqjkmbfpjkdghvomc.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2Y3pxamttYmZwamtkZ2h2b21jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0MjA5MjUsImV4cCI6MjA4NDk5NjkyNX0.Qi9gHILEaBylF8ObdcpXqg9n8wrlX46MFSzlIcZbCG0";return e&&t?(0,i.createBrowserClient)(e,t):null}},9730:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>o});var i=r(5155),s=r(2115),a=r(8525),n=r(63);let l=(0,s.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[u,c]=(0,s.useState)(null),[d,h]=(0,s.useState)(!0),m=(0,n.useRouter)(),f=(0,a.createClient)();(0,s.useEffect)(()=>{if(!f)return void h(!1);let{data:{subscription:e}}=f.auth.onAuthStateChange((e,t)=>{var r;c(t),o(null!=(r=null==t?void 0:t.user)?r:null),h(!1)});return(async()=>{var e;let{data:{session:t}}=await f.auth.getSession();c(t),o(null!=(e=null==t?void 0:t.user)?e:null),h(!1)})(),()=>{e.unsubscribe()}},[f,m]);let x=async(e,t,r)=>{let i=(0,a.createClient)();if(!i)return{error:{message:"Service d'authentification non disponible"}};let{error:s}=await i.auth.signUp({email:e,password:t,options:{data:r}});return{error:s}},g=async(e,t)=>{let r=(0,a.createClient)();if(!r)return{error:{message:"Service d'authentification non disponible"}};let{error:i}=await r.auth.signInWithPassword({email:e,password:t});return m.refresh(),{error:i}},p=async()=>{let e=(0,a.createClient)();e&&(await e.auth.signOut(),m.refresh())},v=async e=>{let t=(0,a.createClient)();if(!t)return{error:{message:"Service d'authentification non disponible"}};let{error:r}=await t.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});return{error:r}},w=async e=>{let t=(0,a.createClient)();if(!t)return{exists:!1,error:{message:"Service d'authentification non disponible"}};try{var r,i;let{error:s}=await t.auth.signInWithPassword({email:e,password:"dummy-password-for-check-only"});if(null==s||null==(r=s.message)?void 0:r.includes("Invalid login credentials"))return{exists:!1,error:null};if(null==s||null==(i=s.message)?void 0:i.includes("Invalid password"))return{exists:!0,error:null};return{exists:!1,error:s}}catch(e){return{exists:!1,error:e}}},b=async(e,t)=>{let r=(0,a.createClient)();if(!r)return{error:{message:"Service d'authentification non disponible"}};let{error:i}=await r.auth.setSession({access_token:e,refresh_token:t});return i||m.refresh(),{error:i}};return(0,i.jsx)(l.Provider,{value:{user:r,session:u,loading:d,signUp:x,signIn:g,signOut:p,resetPassword:v,checkEmailExists:w,confirmEmail:b},children:t})}function u(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[8096,7358],()=>e(e.s=5972)),_N_E=e.O()}]);